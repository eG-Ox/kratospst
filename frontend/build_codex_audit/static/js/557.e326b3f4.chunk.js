"use strict";(self.webpackChunksistema_inventario_frontend=self.webpackChunksistema_inventario_frontend||[]).push([[557],{557(e,a,r){r.r(a),r.d(a,{default:()=>s});var i=r(555),c=r(950),o=r(119),n=r(112),t=r(414);const s=()=>{const[e,a]=(0,c.useState)([]),[r,s]=(0,c.useState)([]),[l,d]=(0,c.useState)([]),[u,h]=(0,c.useState)(!0),[m,p]=(0,c.useState)(""),[x,v]=(0,c.useState)(""),[b,j]=(0,c.useState)([]),[g,N]=(0,c.useState)(!1),[y,_]=(0,c.useState)(!0),[f,w]=(0,c.useState)(!1),[C,A]=(0,c.useState)(!1),[k,E]=(0,c.useState)(null),[S,q]=(0,c.useState)(!1),[M,L]=(0,c.useState)(null),[z,P]=(0,c.useState)(!1),[F,T]=(0,c.useState)(null),[U,H]=(0,c.useState)([]),[R,B]=(0,c.useState)(!1),[D,V]=(0,c.useState)(""),[I,O]=(0,c.useState)({codigo:"",tipo_maquina_id:"",marca:"",descripcion:"",ubicacion_letra:"",ubicacion_numero:"",stock:0,precio_compra:"",precio_venta:"",precio_minimo:0,ficha_web:"",ficha_tecnica:null}),[G,Q]=(0,c.useState)({q:"",tipo:"",marca:"",stock:"all"}),[W,X]=(0,c.useState)(1),[Z,J]=(0,c.useState)(0),[K,Y]=(0,c.useState)({nombre:"",descripcion:""}),$=(0,c.useRef)(null),ee=(0,c.useMemo)(()=>{const e=new Set;return(l||[]).forEach(a=>{const r=String(a.nombre||a.codigo||"").trim();r&&e.add(r)}),Array.from(e).sort((e,a)=>e.localeCompare(a))},[l]),ae=e=>String(e||"").trim().toUpperCase(),re=(0,c.useMemo)(()=>{const e=new Map;return(l||[]).forEach(a=>{const r=ae(a.codigo);r&&e.set(r,String(a.nombre||"").trim())}),e},[l]),ie=e=>{const a=ae(e);return a&&re.has(a)?re.get(a):e||""},ce=(0,c.useCallback)(async()=>{try{const[a,r]=await Promise.all([n.Qu.getAll(),n.FZ.getAll().catch(e=>(console.warn("No se pudieron cargar marcas:",e),{data:[]}))]);if(s(a.data||[]),d(r.data||[]),!f)try{const e=(await n.mc.misPermisos()).data||[];_(e.includes("productos.precio_compra.ver")),w(!0)}catch(e){console.warn("No se pudieron cargar permisos:",e)}}catch(m){console.error("Error cargando catalogos:",m),p("Error al cargar catalogos")}},[f]),oe=(0,c.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:W,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:G;try{var i;h(!0);const c={q:r.q||void 0,tipo:r.tipo||void 0,marca:r.marca||void 0,stock:"all"!==r.stock?r.stock:void 0,page:e,limit:60},o=(await n.rL.getAll(c)).data,t=Array.isArray(o)?o:o.items||[],s=Array.isArray(o)?t.length:null!==(i=o.total)&&void 0!==i?i:t.length;a(t),J(s),p("")}catch(m){console.error("Error cargando productos:",m),p("Error al cargar productos")}finally{h(!1)}},[60,G,W]);(0,c.useEffect)(()=>{ce()},[ce]),(0,c.useEffect)(()=>{const e=G.q?300:0,a=setTimeout(()=>{oe(W,G)},e);return()=>clearTimeout(a)},[oe,G,W]);const ne=()=>{O({codigo:"",tipo_maquina_id:"",marca:"",descripcion:"",ubicacion_letra:"",ubicacion_numero:"",stock:0,precio_compra:"",precio_venta:"",precio_minimo:0,ficha_web:"",ficha_tecnica:null}),E(null)},te=()=>{Y({nombre:"",descripcion:""}),L(null)},se=()=>{P(!1),T(null),H([]),V("")},le=async e=>{try{const a=await n.rL.descargarFichaTecnica(e),r=window.URL.createObjectURL(new Blob([a.data],{type:"application/pdf"}));if(!window.open(r,"_blank","noopener,noreferrer")){const e=document.createElement("a");e.href=r,e.target="_blank",e.rel="noopener noreferrer",document.body.appendChild(e),e.click(),e.remove()}setTimeout(()=>window.URL.revokeObjectURL(r),5e3)}catch(m){console.error("Error descargando ficha t\xe9cnica:",m),p("Error al descargar ficha t\xe9cnica")}},de=()=>{te(),q(!0)},ue=(e,a)=>{const r=window.URL.createObjectURL(new Blob([e])),i=document.createElement("a");i.href=r,i.setAttribute("download",a),document.body.appendChild(i),i.click(),i.remove(),window.URL.revokeObjectURL(r)},he=e=>{const a=(null===e||void 0===e?void 0:e.ubicacion_letra)||"",r=(null===e||void 0===e?void 0:e.ubicacion_numero)||"";return a||r?"".concat(a).concat(r):"-"},me=Math.max(Math.ceil(Z/60)||1,1);return(0,t.jsxs)("div",{className:"productos-container",children:[(0,t.jsxs)("div",{className:"productos-header",children:[(0,t.jsx)("h1",{children:"Productos / M?quinas"}),(0,t.jsxs)("div",{className:"header-actions",children:[(0,t.jsx)("button",{className:"btn-secondary",onClick:async()=>{try{const e=await n.rL.descargarPlantilla();ue(e.data,"plantilla_productos.xlsx")}catch(e){console.error("Error descargando plantilla:",e),p("Error al descargar plantilla")}},children:"Plantilla Excel"}),(0,t.jsx)("button",{className:"btn-secondary",onClick:()=>{$.current&&$.current.click()},disabled:g,children:g?"Importando...":"Importar Excel"}),(0,t.jsx)("button",{className:"btn-secondary",onClick:async()=>{try{const e=await n.rL.exportarExcel();ue(e.data,"productos.xlsx")}catch(e){console.error("Error exportando productos:",e),p("Error al exportar productos")}},children:"Exportar Excel"}),(0,t.jsx)("button",{className:"btn-primary",onClick:()=>{ne(),A(!0)},children:"+ Nuevo Producto"}),(0,t.jsx)("button",{className:"btn-secondary",onClick:de,children:"+ Nuevo Tipo"})]})]}),m&&(0,t.jsx)("div",{className:"error-message",children:m}),x&&(0,t.jsx)("div",{className:"success-message",children:x}),b.length>0&&(0,t.jsxs)("div",{className:"warning-message",children:[(0,t.jsx)("strong",{children:"Errores en importaci?n:"}),(0,t.jsxs)("ul",{children:[b.slice(0,6).map(e=>(0,t.jsx)("li",{children:e},e)),b.length>6&&(0,t.jsx)("li",{children:"Hay m?s errores. Revisa el archivo."})]})]}),(0,t.jsx)("input",{ref:$,type:"file",accept:".xlsx,.xls",onChange:async e=>{var a;const r=null===(a=e.target.files)||void 0===a?void 0:a[0];if(r)try{N(!0),p(""),v(""),j([]);const e=new FormData;e.append("archivo",r);const a=await n.rL.importarExcel(e),{insertados:i,duplicados:c,errores:o}=a.data||{};v("Importados: ".concat(i||0," | Duplicados: ").concat((null===c||void 0===c?void 0:c.length)||0," | Errores: ").concat((null===o||void 0===o?void 0:o.length)||0)),j(o||[]),X(1),await oe(1,G)}catch(o){var i,c;console.error("Error importando productos:",o),p((null===(i=o.response)||void 0===i||null===(c=i.data)||void 0===c?void 0:c.error)||"Error al importar productos")}finally{N(!1),e.target&&(e.target.value="")}},style:{display:"none"}}),u?(0,t.jsx)("div",{className:"loading",children:"Cargando productos..."}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{className:"productos-filters",children:[(0,t.jsx)("input",{type:"text",placeholder:"Buscar codigo, descripcion, marca...",value:G.q,onChange:e=>{Q(a=>(0,i.A)((0,i.A)({},a),{},{q:e.target.value})),X(1)}}),(0,t.jsxs)("select",{value:G.tipo,onChange:e=>{Q(a=>(0,i.A)((0,i.A)({},a),{},{tipo:e.target.value})),X(1)},children:[(0,t.jsx)("option",{value:"",children:"Tipo"}),r.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nombre},e.id))]}),(0,t.jsxs)("select",{value:G.marca,onChange:e=>{Q(a=>(0,i.A)((0,i.A)({},a),{},{marca:e.target.value})),X(1)},children:[(0,t.jsx)("option",{value:"",children:"Marca"}),ee.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]}),(0,t.jsxs)("select",{value:G.stock,onChange:e=>{Q(a=>(0,i.A)((0,i.A)({},a),{},{stock:e.target.value})),X(1)},children:[(0,t.jsx)("option",{value:"all",children:"Stock"}),(0,t.jsx)("option",{value:"sin",children:"Sin stock"})]}),(0,t.jsx)("button",{type:"button",className:"btn-secondary icon-btn-inline",onClick:()=>{Q({q:"",tipo:"",marca:"",stock:"all"}),X(1)},title:"Limpiar","aria-label":"Limpiar filtros",children:(0,t.jsxs)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:[(0,t.jsx)("path",{d:"M6 6h12v2H6z"}),(0,t.jsx)("path",{d:"M9 11h6v2H9z"}),(0,t.jsx)("path",{d:"M11 16h2v2h-2z"})]})})]}),(0,t.jsxs)("div",{className:"productos-table-container",children:[e.length>0?(0,t.jsxs)("table",{className:"productos-table",children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{children:"C\xf3digo"}),(0,t.jsx)("th",{children:"Tipo"}),(0,t.jsx)("th",{children:"Marca"}),(0,t.jsx)("th",{children:"Descripci\xf3n"}),(0,t.jsx)("th",{children:"Ubicaci\xf3n"}),(0,t.jsx)("th",{children:"Stock"}),y&&(0,t.jsx)("th",{children:"Precio Compra"}),(0,t.jsx)("th",{children:"Precio Venta"}),(0,t.jsx)("th",{children:"Precio M\xednimo"}),(0,t.jsx)("th",{children:"Ficha Web"}),(0,t.jsx)("th",{children:"Ficha T\xe9cnica"}),(0,t.jsx)("th",{children:"Acciones"})]})}),(0,t.jsx)("tbody",{children:e.map(a=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{children:a.codigo}),(0,t.jsx)("td",{children:a.tipo_nombre}),(0,t.jsx)("td",{children:ie(a.marca)}),(0,t.jsx)("td",{children:a.descripcion||"-"}),(0,t.jsx)("td",{children:he(a)}),(0,t.jsx)("td",{className:Number(a.stock||0)<=0?"low-stock":"",children:a.stock}),y&&(0,t.jsxs)("td",{children:["S/. ",Number(a.precio_compra||0).toFixed(2)]}),(0,t.jsxs)("td",{children:["S/. ",Number(a.precio_venta||0).toFixed(2)]}),(0,t.jsxs)("td",{children:["S/. ",Number(a.precio_minimo||0).toFixed(2)]}),(0,t.jsx)("td",{className:"icon-col",children:a.ficha_web?(0,t.jsx)("a",{className:"icon-btn",href:a.ficha_web,target:"_blank",rel:"noreferrer",title:"Ficha Web","aria-label":"Ficha Web",children:(0,t.jsx)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:(0,t.jsx)("path",{d:"M12 2a10 10 0 1 0 0 20a10 10 0 0 0 0-20zm6.9 9h-3.12a15.4 15.4 0 0 0-1.2-5A8.03 8.03 0 0 1 18.9 11zM12 4c1.02 1.3 1.82 3.31 2.2 5H9.8c.38-1.69 1.18-3.7 2.2-5zM5.1 13h3.12a15.4 15.4 0 0 0 1.2 5A8.03 8.03 0 0 1 5.1 13zm0-2a8.03 8.03 0 0 1 4.22-5a15.4 15.4 0 0 0-1.2 5H5.1zm6.9 9c-1.02-1.3-1.82-3.31-2.2-5h4.4c-.38 1.69-1.18 3.7-2.2 5zm2.78-2a15.4 15.4 0 0 0 1.2-5h3.12a8.03 8.03 0 0 1-4.32 5z"})})}):"-"}),(0,t.jsx)("td",{className:"icon-col",children:a.ficha_tecnica_ruta?(0,t.jsx)("button",{className:"icon-btn",onClick:()=>le(a.ficha_tecnica_ruta),title:"Ficha Tecnica","aria-label":"Ficha Tecnica",children:(0,t.jsx)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:(0,t.jsx)("path",{d:"M6 2h9l5 5v15a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm8 1.5V8h4.5L14 3.5zM8 12h8v2H8v-2zm0 4h8v2H8v-2z"})})}):"-"}),(0,t.jsxs)("td",{className:"acciones",children:[(0,t.jsx)("button",{className:"icon-btn",onClick:()=>(async e=>{T(e),H([]),V(""),B(!0),P(!0);try{const a=await n.rL.getUbicaciones(e.id);H(a.data||[])}catch(a){console.error("Error cargando ubicaciones:",a),V("No se pudieron cargar las ubicaciones.")}finally{B(!1)}})(a),title:"Ubicaciones","aria-label":"Ubicaciones",children:(0,t.jsx)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:(0,t.jsx)("path",{d:"M12 2a7 7 0 0 0-7 7c0 4.2 5.3 11 7 11s7-6.8 7-11a7 7 0 0 0-7-7zm0 9.5a2.5 2.5 0 1 1 0-5 2.5 2.5 0 0 1 0 5z"})})}),(0,t.jsx)("button",{className:"icon-btn icon-btn--edit",onClick:()=>(e=>{var a,r,i,c,o;O({codigo:e.codigo||"",tipo_maquina_id:e.tipo_maquina_id?String(e.tipo_maquina_id):"",marca:e.marca||"",descripcion:e.descripcion||"",ubicacion_letra:e.ubicacion_letra||"",ubicacion_numero:null!==(a=e.ubicacion_numero)&&void 0!==a?a:"",stock:Number(null!==(r=e.stock)&&void 0!==r?r:0),precio_compra:null!==(i=e.precio_compra)&&void 0!==i?i:"",precio_venta:null!==(c=e.precio_venta)&&void 0!==c?c:"",precio_minimo:null!==(o=e.precio_minimo)&&void 0!==o?o:0,ficha_web:e.ficha_web||"",ficha_tecnica:null}),E(e),A(!0)})(a),title:"Editar","aria-label":"Editar",children:(0,t.jsx)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:(0,t.jsx)("path",{d:"M3 17.25V21h3.75L17.8 9.94l-3.75-3.75L3 17.25zm2.92 2.83H5v-.92l9.06-9.06.92.92L5.92 20.08zM20.71 7.04a1 1 0 0 0 0-1.41L18.37 3.3a1 1 0 0 0-1.41 0l-1.84 1.84 3.75 3.75 1.84-1.85z"})})}),(0,t.jsx)("button",{className:"icon-btn icon-btn--delete",onClick:()=>(async a=>{if(window.confirm("\xbfEst\xe1s seguro de que deseas eliminar este producto?"))try{await n.rL.delete(a),1===e.length&&W>1?X(e=>Math.max(e-1,1)):await oe(W,G)}catch(m){console.error("Error eliminando producto:",m),p("Error al eliminar producto")}})(a.id),title:"Eliminar","aria-label":"Eliminar",children:(0,t.jsx)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:(0,t.jsx)("path",{d:"M6 7h12l-1 14a2 2 0 0 1-2 2H9a2 2 0 0 1-2-2L6 7zm3-4h6l1 2h4v2H4V5h4l1-2z"})})})]})]},a.id))})]}):(0,t.jsx)("p",{className:"empty-message",children:"No hay productos creados"}),e.length>0&&(0,t.jsxs)("div",{className:"table-pagination",children:[(0,t.jsxs)("span",{children:["Mostrando ",e.length," de ",Z]}),(0,t.jsxs)("div",{className:"page-controls",children:[(0,t.jsx)("button",{type:"button",className:"btn-secondary btn-small",onClick:()=>X(e=>Math.max(e-1,1)),disabled:W<=1,children:"Anterior"}),(0,t.jsxs)("span",{children:["Pagina ",W," / ",me]}),(0,t.jsx)("button",{type:"button",className:"btn-secondary btn-small",onClick:()=>X(e=>Math.min(e+1,me)),disabled:W>=me,children:"Siguiente"})]})]})]})]}),C&&(0,o.createPortal)((0,t.jsx)("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsxs)("div",{className:"modal-header",children:[(0,t.jsx)("h2",{children:k?"Editar Producto":"Nuevo Producto"}),(0,t.jsx)("button",{type:"button",className:"btn-icon",onClick:()=>{ne(),A(!1)},children:"X"})]}),(0,t.jsxs)("form",{onSubmit:async e=>{e.preventDefault();try{const e=(0,i.A)({},I);k&&!y&&delete e.precio_compra,k?await n.rL.update(k.id,e):await n.rL.create(e),ne(),A(!1),await oe(W,G)}catch(m){var a,r;console.error("Error guardando producto:",m),p((null===(a=m.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.error)||"Error al guardar producto")}},children:[(0,t.jsxs)("div",{className:"modal-body",children:[(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"C\xf3digo *"}),(0,t.jsx)("input",{type:"text",required:!0,value:I.codigo,onChange:e=>O((0,i.A)((0,i.A)({},I),{},{codigo:e.target.value}))})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Tipo de M\xe1quina *"}),(0,t.jsxs)("select",{required:!0,value:I.tipo_maquina_id,onChange:e=>O((0,i.A)((0,i.A)({},I),{},{tipo_maquina_id:e.target.value})),children:[(0,t.jsx)("option",{value:"",children:"Seleccionar tipo"}),r.map(e=>(0,t.jsx)("option",{value:e.id,children:e.nombre},e.id))]}),(0,t.jsx)("button",{type:"button",className:"btn-link",onClick:de,children:"+ Agregar tipo si no est\xe1 en la lista"})]})]}),(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Marca *"}),(0,t.jsx)("input",{type:"text",required:!0,value:I.marca,onChange:e=>O((0,i.A)((0,i.A)({},I),{},{marca:e.target.value}))})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Descripci\xf3n"}),(0,t.jsx)("input",{type:"text",value:I.descripcion,onChange:e=>O((0,i.A)((0,i.A)({},I),{},{descripcion:e.target.value}))})]})]}),(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Ubicaci\xf3n (Letra)"}),(0,t.jsxs)("select",{value:I.ubicacion_letra,onChange:e=>O((0,i.A)((0,i.A)({},I),{},{ubicacion_letra:e.target.value})),children:[(0,t.jsx)("option",{value:"",children:"-"}),["A","B","C","D","E","F","G","H"].map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Ubicaci\xf3n (N\xfamero)"}),(0,t.jsx)("input",{type:"number",min:"1",placeholder:"Ej. 1",value:I.ubicacion_numero,onChange:e=>O((0,i.A)((0,i.A)({},I),{},{ubicacion_numero:e.target.value}))})]})]}),(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Stock"}),(0,t.jsx)("input",{type:"number",min:"0",value:I.stock,onChange:e=>O((0,i.A)((0,i.A)({},I),{},{stock:parseInt(e.target.value,10)||0}))})]}),y&&(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Precio Compra *"}),(0,t.jsx)("input",{type:"number",required:!0,step:"0.01",value:I.precio_compra,onChange:e=>O((0,i.A)((0,i.A)({},I),{},{precio_compra:e.target.value}))})]})]}),(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Precio Venta *"}),(0,t.jsx)("input",{type:"number",required:!0,step:"0.01",value:I.precio_venta,onChange:e=>O((0,i.A)((0,i.A)({},I),{},{precio_venta:e.target.value}))})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Precio M\xednimo"}),(0,t.jsx)("input",{type:"number",min:"0",step:"0.01",value:I.precio_minimo,onChange:e=>O((0,i.A)((0,i.A)({},I),{},{precio_minimo:e.target.value}))})]})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"URL Ficha T\xe9cnica"}),(0,t.jsx)("input",{type:"url",value:I.ficha_web,onChange:e=>O((0,i.A)((0,i.A)({},I),{},{ficha_web:e.target.value}))})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Archivo Ficha T\xe9cnica (PDF)"}),(0,t.jsx)("input",{type:"file",accept:".pdf",onChange:e=>{var a;return O((0,i.A)((0,i.A)({},I),{},{ficha_tecnica:(null===(a=e.target.files)||void 0===a?void 0:a[0])||null}))}}),(null===k||void 0===k?void 0:k.ficha_tecnica_ruta)&&(0,t.jsx)("button",{type:"button",className:"btn-link",onClick:()=>le(k.ficha_tecnica_ruta),children:"Descargar ficha actual"})]})]}),(0,t.jsxs)("div",{className:"modal-footer",children:[(0,t.jsx)("button",{type:"submit",className:"btn-success",children:k?"Guardar Cambios":"Crear Producto"}),(0,t.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>{ne(),A(!1)},children:"Cancelar"})]})]})]})}),document.body),S&&(0,o.createPortal)((0,t.jsx)("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsxs)("div",{className:"modal-header",children:[(0,t.jsx)("h2",{children:M?"Editar Tipo de M\xe1quina":"Nuevo Tipo de M\xe1quina"}),(0,t.jsx)("button",{type:"button",className:"btn-icon",onClick:()=>{te(),q(!1)},children:"X"})]}),(0,t.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),K.nombre)try{if(M){const e=await n.Qu.update(M.id,K),a=(null===e||void 0===e?void 0:e.data)||(0,i.A)((0,i.A)({},K),{},{id:M.id});s(e=>e.map(e=>e.id===M.id?(0,i.A)((0,i.A)({},e),a):e))}else{var a;const e=await n.Qu.create(K);null!==e&&void 0!==e&&null!==(a=e.data)&&void 0!==a&&a.id&&(O(a=>(0,i.A)((0,i.A)({},a),{},{tipo_maquina_id:String(e.data.id)})),s(a=>[...a,e.data]))}te(),q(!1)}catch(m){var r,c;console.error("Error guardando tipo de m\xe1quina:",m),p((null===(r=m.response)||void 0===r||null===(c=r.data)||void 0===c?void 0:c.error)||"Error al guardar tipo de m\xe1quina")}else p("El nombre del tipo de m\xe1quina es requerido")},children:[(0,t.jsx)("div",{className:"modal-body",children:(0,t.jsxs)("div",{className:"form-row",children:[(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Nombre *"}),(0,t.jsx)("input",{type:"text",required:!0,value:K.nombre,onChange:e=>Y((0,i.A)((0,i.A)({},K),{},{nombre:e.target.value}))})]}),(0,t.jsxs)("div",{className:"form-group",children:[(0,t.jsx)("label",{children:"Descripci\xf3n"}),(0,t.jsx)("input",{type:"text",value:K.descripcion,onChange:e=>Y((0,i.A)((0,i.A)({},K),{},{descripcion:e.target.value}))})]})]})}),(0,t.jsxs)("div",{className:"modal-footer",children:[(0,t.jsx)("button",{type:"submit",className:"btn-success",children:M?"Guardar Tipo":"Crear Tipo"}),(0,t.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>{te(),q(!1)},children:"Cancelar"})]})]})]})}),document.body),z&&(0,o.createPortal)((0,t.jsx)("div",{className:"modal-overlay",children:(0,t.jsxs)("div",{className:"modal-content",children:[(0,t.jsxs)("div",{className:"modal-header",children:[(0,t.jsxs)("h2",{children:["Ubicaciones ",null!==F&&void 0!==F&&F.codigo?"(".concat(F.codigo,")"):""]}),(0,t.jsx)("button",{type:"button",className:"btn-icon",onClick:se,children:"X"})]}),(0,t.jsx)("div",{className:"modal-body",children:R?(0,t.jsx)("div",{className:"loading",children:"Cargando ubicaciones..."}):D?(0,t.jsx)("div",{className:"error-message",children:D}):0===U.length?(0,t.jsx)("div",{className:"empty-message",children:"Sin ubicaciones con stock."}):(0,t.jsx)("ul",{className:"ubicaciones-list",children:U.map(e=>(0,t.jsxs)("li",{children:[e.ubicacion_letra,e.ubicacion_numero," - ",e.stock]},"".concat(e.ubicacion_letra).concat(e.ubicacion_numero)))})}),(0,t.jsx)("div",{className:"modal-footer",children:(0,t.jsx)("button",{type:"button",className:"btn-secondary",onClick:se,children:"Cerrar"})})]})}),document.body)]})}}}]);