"use strict";(self.webpackChunksistema_inventario_frontend=self.webpackChunksistema_inventario_frontend||[]).push([[32],{32(e,a,n){n.r(a),n.d(a,{default:()=>s});var r=n(950),i=n(534),t=n(112),o=n(414);const c=e=>String(e||"").trim().toUpperCase().replace(/[^A-Z0-9]/g,""),s=()=>{const[e,a]=(0,r.useState)(null),[n,s]=(0,r.useState)("abierto"),[l,d]=(0,r.useState)(null),[u,h]=(0,r.useState)([]),[m,v]=(0,r.useState)([]),[x,j]=(0,r.useState)([]),[p,b]=(0,r.useState)("conteo"),[N,g]=(0,r.useState)(""),[y,f]=(0,r.useState)(""),[w,C]=(0,r.useState)(""),[k,S]=(0,r.useState)(!1),[_,E]=(0,r.useState)(!1),[z,A]=(0,r.useState)(!1),[H,D]=(0,r.useState)(!1),[T,V]=(0,r.useState)(""),[I,R]=(0,r.useState)(""),[U,L]=(0,r.useState)(""),[Z,O]=(0,r.useState)("producto"),[M,Q]=(0,r.useState)("zona"),[P,B]=(0,r.useState)(null),[F,G]=(0,r.useState)(""),q=(0,r.useRef)(null),J=(0,r.useRef)(null),K=(0,r.useRef)(null),W=(0,r.useRef)(null),X=(0,r.useRef)(!1),$=(0,r.useRef)(0),Y=(0,r.useRef)(""),ee=(0,r.useRef)(0),ae=(0,r.useRef)(null),ne=(0,r.useRef)(null),re=(0,r.useMemo)(()=>{try{return JSON.parse(localStorage.getItem("usuario")||"{}")}catch(e){return{}}},[]),ie=(0,r.useMemo)(()=>x.find(e=>"abierto"===e.estado),[x]),te=(0,r.useCallback)(async()=>{try{const e=await t.rL.getAll({page:1,limit:2e3}),a=null===e||void 0===e?void 0:e.data,n=Array.isArray(a)?a:(null===a||void 0===a?void 0:a.items)||[];h(n)}catch(e){console.error("Error cargando productos:",e),f("Error al cargar productos")}},[2e3]),oe=(0,r.useCallback)(async e=>{try{const a=await t.rL.getByCodigo(e),n=null===a||void 0===a?void 0:a.data;if(null!==n&&void 0!==n&&n.id)return h(e=>e.some(e=>c(e.codigo)===c(n.codigo))?e:[...e,n]),n}catch(n){var a;404!==(null===n||void 0===n||null===(a=n.response)||void 0===a?void 0:a.status)&&console.error("Error buscando producto por codigo:",n)}return null},[]),ce=(0,r.useCallback)(async()=>{try{const e=await t.HV.listar();j(e.data||[])}catch(e){console.error("Error cargando historial:",e)}},[]),se=async e=>{try{f("");const n=await t.HV.obtener(e);a(n.data.inventario.id),s(n.data.inventario.estado),d(n.data.inventario),v(n.data.detalles||[]),b("conteo"),A(!1)}catch(n){console.error("Error cargando inventario:",n),f("No se pudo cargar inventario")}},le=(0,r.useCallback)(async()=>{try{const e=window.AudioContext||window.webkitAudioContext;if(!e)return;ae.current||(ae.current=new e);const a=ae.current;return"suspended"===a.state&&await a.resume(),a}catch(e){return console.warn("No se pudo habilitar audio:",e),null}},[ae]),de=(0,r.useCallback)(async()=>{try{const e=await le();if(!e)return;const a=e.createOscillator(),n=e.createGain();a.type="sine",a.frequency.value=900,n.gain.value=.12,a.connect(n),n.connect(e.destination),a.start(),setTimeout(()=>{a.stop(),a.disconnect(),n.disconnect()},120)}catch(e){console.warn("No se pudo reproducir el beep:",e)}},[le]),ue=(0,r.useCallback)(()=>{f(""),C("")},[]),he=(0,r.useCallback)(async()=>{if(!e)return;const a=await t.HV.obtener(e);v(a.data.detalles||[]),s(a.data.inventario.estado),d(a.data.inventario)},[e]),me=(0,r.useCallback)(()=>{ne.current&&clearTimeout(ne.current),ne.current=setTimeout(()=>{ne.current=null,he()},400)},[he,ne]),ve=(0,r.useCallback)(e=>{const a=String(e||"").trim();if(!a)return f("QR invalido"),null;return{codigo:a.replace(/\r/g,"").split(/[\n,;/\s]+/g).map(e=>e.trim()).filter(Boolean)[0]||a,partial:!0}},[]),xe=(0,r.useCallback)(e=>{const a=String(e||"").trim().toUpperCase();if(!a)return{error:"Zona vacia"};const n=(a.startsWith("ZONA:")?a.replace("ZONA:","").trim():a).match(/^([A-H])\s*(\d+)$/);if(!n)return{error:"Zona invalida. Usa ZONA:A1 o A1"};const r=Number(n[2]);return!Number.isInteger(r)||1!==r&&2!==r?{error:"Subzona invalida. Solo se permite 1 o 2"}:{letra:n[1],numero:r}},[]),je=(0,r.useCallback)(async a=>{if(!e)return void f("Inicia un inventario primero");const n=I&&U?"".concat(I).concat(U).trim().toUpperCase():"H1";if(a)try{ue();let r=String(a||"").trim();if(r.includes("\n")||(r.match(/,/g)||[]).length>=1){const e=ve(r);if(!e)return;null!==e&&void 0!==e&&e.codigo&&(r=e.codigo)}const i=c(r);let o=u.find(e=>c(e.codigo)===i);if(o||(o=await oe(r)),!o)return B(!1),G(r),f("QR no registrado: ".concat(r)),void g("");await t.HV.agregar(e,{codigo:r,cantidad:1,ubicacion:n}),me(),de(),B(!0),G(r),C("Codigo leido: ".concat(r)),setTimeout(()=>C(""),900),g("")}catch(o){var r,i;console.error("Error agregando conteo:",o),f((null===(r=o.response)||void 0===r||null===(i=r.data)||void 0===i?void 0:i.error)||"Error agregando conteo")}},[e,I,U,ue,ve,u,oe,me,de]),pe=async()=>{if(e)try{await t.HV.cerrar(e),await he(),await ce()}catch(r){var a,n;console.error("Error cerrando inventario:",r),f((null===(a=r.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.error)||"Error al cerrar inventario")}},be=()=>{"undefined"!==typeof window&&window.Android&&"function"===typeof window.Android.openQrScanner?window.Android.openQrScanner():(f(""),le(),Y.current="",ee.current=0,S(!0))},Ne=(0,r.useCallback)(()=>{X.current=!1,E(!1),W.current&&"function"===typeof W.current.stop&&W.current.stop(),W.current=null,J.current&&(J.current.getTracks().forEach(e=>e.stop()),J.current=null),q.current&&(q.current.srcObject=null)},[]),ge=(0,r.useCallback)(()=>{Ne(),S(!1)},[Ne]),ye=(0,r.useCallback)(()=>{if(X.current||!q.current)return;X.current=!0,E(!0);const e=K.current.decodeFromVideoDevice(void 0,q.current,e=>{if(e&&X.current){const a=Date.now();if(a-$.current>700){$.current=a;const n=e.getText(),r=Date.now();if(n===Y.current&&r-ee.current<1200)return;if(Y.current=n,ee.current=r,"zona"===Z){const e=xe(n);if(e.error)return void f(e.error);R(e.letra),L(String(e.numero)),Q("scan"),C("Zona activa: ".concat(e.letra).concat(e.numero)),setTimeout(()=>C(""),1200)}else{const e=ve(n);if(!e)return;null!==e&&void 0!==e&&e.codigo?(g(e.codigo),je(e.codigo)):(g(n),je(n))}ge()}}});W.current=e},[je,ge,ve,xe,Z]),fe=(0,r.useCallback)(async()=>{if(k)try{if(!window.isSecureContext)return f("Para usar la camara en celular necesitas HTTPS."),void S(!1);if(!q.current)return void setTimeout(fe,120);if(K.current||(K.current=new i.sx),!J.current){J.current=await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720},focusMode:"continuous"},audio:!1});try{var e;const[a]=J.current.getVideoTracks(),n=null===a||void 0===a||null===(e=a.getCapabilities)||void 0===e?void 0:e.call(a);null!==n&&void 0!==n&&n.torch&&await a.applyConstraints({advanced:[{torch:!0}]})}catch(a){}}if(q.current&&J.current){q.current.srcObject=J.current;const e=q.current.play();e&&"function"===typeof e.catch&&e.catch(()=>{}),setTimeout(()=>ye(),250)}}catch(a){console.error("Error camara:",a),f("No se pudo acceder a la camara"),S(!1)}},[k,ye]);(0,r.useEffect)(()=>(te(),ce(),()=>{Ne()}),[te,ce,Ne]),(0,r.useEffect)(()=>{k?fe():Ne()},[k,fe,Ne]);const we=e=>{if(!e)return"-";const a=e.ubicacion_letra||"",n=e.ubicacion_numero||"";return a||n?"".concat(a).concat(n):"-"};(0,r.useEffect)(()=>{const e=e=>{if(!e)return;const a=Date.now();if(a-$.current>1200){$.current=a;const n=Date.now();if(e===Y.current&&n-ee.current<2500)return;if(Y.current=e,ee.current=n,"zona"===Z){const a=xe(e);if(a.error)return void f(a.error);R(a.letra),L(String(a.numero)),C("Zona activa: ".concat(a.letra).concat(a.numero)),setTimeout(()=>C(""),1200)}else{const a=ve(e);if(!a)return;const n=null!==a&&void 0!==a&&a.codigo?a.codigo:String(e);g(n),je(n)}ge()}};return window.handleNativeQr=e,()=>{window.handleNativeQr===e&&delete window.handleNativeQr}},[Z,ve,xe,je,u,ge]);const Ce="cerrado"===n,ke=null!==l&&void 0!==l&&l.created_at?new Date(l.created_at).toLocaleString():"";return(0,o.jsxs)("div",{className:"inventario-general-container",children:[(0,o.jsxs)("div",{className:"page-header",children:[(0,o.jsxs)("div",{className:"page-header__title",children:[(0,o.jsx)("h5",{children:"Inventario General"}),(0,o.jsx)("span",{className:"page-header__subtitle",children:"Conteo rapido por pistoleo"})]}),(0,o.jsxs)("div",{className:"page-header__actions",children:[(0,o.jsx)("span",{className:"status-badge ".concat(e?"ok":"warn"),children:e?n:"Sin inventario"}),(0,o.jsxs)("span",{className:"status-pill",children:["Items: ",m.length]}),e&&(0,o.jsxs)("span",{className:"status-meta",children:[null!==l&&void 0!==l&&l.usuario_nombre?"Usuario: ".concat(l.usuario_nombre):"Usuario: --",ke?" | ".concat(ke):""]}),(0,o.jsxs)("div",{className:"header-buttons",children:[(0,o.jsx)("button",{type:"button",className:"btn-secondary",onClick:async()=>{await ce(),A(!0)},children:"Nuevo"}),(0,o.jsx)("button",{type:"button",className:"btn-secondary",onClick:pe,children:"Cerrar"}),(0,o.jsx)("button",{type:"button",className:"btn-primary",onClick:async()=>{var e;await ce();const a=null!==x&&void 0!==x&&null!==(e=x[0])&&void 0!==e&&e.id?String(x[0].id):"";V(a),D(!0)},disabled:!Ce,children:"Actualizar stock"})]})]})]}),y&&(0,o.jsx)("div",{className:"error-message",children:y}),w&&(0,o.jsx)("div",{className:"success-message",children:w}),(0,o.jsxs)("div",{className:"tabs",children:[(0,o.jsx)("button",{className:"conteo"===p?"active":"",onClick:()=>b("conteo"),children:"Conteo"}),(0,o.jsx)("button",{className:"historial"===p?"active":"",onClick:()=>b("historial"),children:"Historial"})]}),"conteo"===p&&(0,o.jsx)("div",{className:"inventario-flow",children:"zona"===M?(0,o.jsx)("div",{className:"inventario-zone-setup",children:(0,o.jsxs)("div",{className:"zone-card",children:[(0,o.jsx)("h3",{children:"Selecciona zona"}),(0,o.jsxs)("div",{className:"zone-grid",children:[(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Zona"}),(0,o.jsxs)("select",{value:I,onChange:e=>R(e.target.value),children:[(0,o.jsx)("option",{value:"",children:"-"}),["A","B","C","D","E","F","G","H"].map(e=>(0,o.jsx)("option",{value:e,children:e},e))]})]}),(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Subzona"}),(0,o.jsxs)("select",{value:U,onChange:e=>L(e.target.value),children:[(0,o.jsx)("option",{value:"",children:"-"}),(0,o.jsx)("option",{value:"1",children:"1"}),(0,o.jsx)("option",{value:"2",children:"2"})]})]}),(0,o.jsxs)("div",{className:"zone-actions",children:[(0,o.jsx)("button",{type:"button",className:"btn-secondary icon-btn-inline",onClick:()=>{O("zona"),be()},title:"Escanear zona","aria-label":"Escanear zona",children:"\ud83d\udcf7"}),(0,o.jsx)("button",{type:"button",className:"btn-primary",onClick:()=>{I&&U?Q("scan"):f("Selecciona zona y subzona")},children:"Iniciar zona"})]})]})]})}):(0,o.jsx)("div",{className:"inventario-scan-layout",children:(0,o.jsxs)("div",{className:"scan-panel",children:[(0,o.jsxs)("div",{className:"scan-header",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("h3",{children:"Zona activa"}),(0,o.jsx)("p",{className:"zone-pill",children:I&&U?"".concat(I).concat(U):"H1"})]}),(0,o.jsxs)("div",{className:"scan-actions",children:[(0,o.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>{R(""),L(""),Q("zona")},children:"Terminar zona"}),(0,o.jsx)("button",{type:"button",className:"btn-secondary",onClick:pe,children:"Terminar inventario"})]})]}),(0,o.jsxs)("div",{className:"scan-input-card",children:[(0,o.jsxs)("div",{className:"scan-input-row",children:[(0,o.jsx)("input",{id:"codigo",type:"text",value:N,onChange:e=>g(e.target.value.trim()),placeholder:"Escanea o escribe el codigo"}),(0,o.jsx)("button",{type:"button",className:"btn-camera",onClick:()=>{O("producto"),be()},"aria-label":"Abrir camara",children:(0,o.jsx)("svg",{viewBox:"0 0 24 24","aria-hidden":"true",children:(0,o.jsx)("path",{d:"M4 7h3l2-2h6l2 2h3a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2zm8 3a4 4 0 1 0 .001 8.001A4 4 0 0 0 12 10z"})})})]}),(0,o.jsx)("button",{type:"button",className:"btn-primary",onClick:()=>je(N),children:"Agregar"}),(0,o.jsx)("div",{className:"scan-status ".concat(null===P?"":P?"ok":"bad"),children:null===P?(0,o.jsx)("span",{children:"Listo para escanear"}):P?(0,o.jsxs)("span",{children:["OK: ",F]}):(0,o.jsxs)("span",{children:["Error: ",F]})})]}),(0,o.jsx)("div",{className:"inventario-table-container",children:(0,o.jsxs)("table",{className:"inventario-table",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"Codigo"}),(0,o.jsx)("th",{children:"Descripcion"}),(0,o.jsx)("th",{children:"Ubicacion"}),(0,o.jsx)("th",{children:"Stock"}),(0,o.jsx)("th",{children:"Conteo"}),(0,o.jsx)("th",{children:"Diferencia"}),(0,o.jsx)("th",{})]})}),(0,o.jsx)("tbody",{children:0===m.length?(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:"6",className:"empty-message",children:"No hay conteos. Empieza a escanear."})}):m.map(a=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:a.codigo}),(0,o.jsx)("td",{children:a.descripcion}),(0,o.jsx)("td",{children:we(a)}),(0,o.jsx)("td",{children:a.stock_actual}),(0,o.jsx)("td",{children:(0,o.jsx)("input",{type:"number",value:a.conteo,onChange:n=>(async(a,n)=>{if(e)try{await t.HV.ajustar(e,{detalle_id:a,conteo:Number(n||0)}),await he()}catch(o){var r,i;console.error("Error ajustando conteo:",o),f((null===(r=o.response)||void 0===r||null===(i=r.data)||void 0===i?void 0:i.error)||"Error ajustando conteo")}})(a.id,n.target.value)})}),(0,o.jsx)("td",{className:0===a.diferencia?"":a.diferencia>0?"diff-plus":"diff-minus",children:a.diferencia}),(0,o.jsx)("td",{children:(0,o.jsx)("button",{type:"button",className:"icon-btn icon-btn--delete",onClick:()=>(async a=>{if(!e)return;if(window.confirm("Deseas eliminar este producto del conteo?"))try{await t.HV.eliminar(e,{detalle_id:a}),await he()}catch(i){var n,r;console.error("Error eliminando detalle:",i),f((null===(n=i.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.error)||"Error al eliminar detalle")}})(a.id),title:"Eliminar","aria-label":"Eliminar",children:"\ud83d\uddd1\ufe0f"})})]},a.id))})]})})]})})}),"historial"===p&&(0,o.jsx)("div",{className:"inventario-historial",children:(0,o.jsx)("div",{className:"inventario-table-container",children:(0,o.jsxs)("table",{className:"inventario-table",children:[(0,o.jsx)("thead",{children:(0,o.jsxs)("tr",{children:[(0,o.jsx)("th",{children:"ID"}),(0,o.jsx)("th",{children:"Fecha"}),(0,o.jsx)("th",{children:"Usuario"}),(0,o.jsx)("th",{children:"Estado"}),(0,o.jsx)("th",{children:"Items"}),(0,o.jsx)("th",{className:"icon-col",title:"Acciones",children:(0,o.jsx)("span",{className:"icon-label","aria-label":"Acciones",children:"\u22ef"})})]})}),(0,o.jsx)("tbody",{children:0===x.length?(0,o.jsx)("tr",{children:(0,o.jsx)("td",{colSpan:"6",className:"empty-message",children:"No hay inventarios registrados."})}):x.map(e=>(0,o.jsxs)("tr",{children:[(0,o.jsx)("td",{children:e.id}),(0,o.jsx)("td",{children:new Date(e.created_at).toLocaleString()}),(0,o.jsx)("td",{children:e.usuario_nombre||e.usuario_id}),(0,o.jsx)("td",{children:e.estado}),(0,o.jsx)("td",{children:e.total_items}),(0,o.jsxs)("td",{className:"acciones",children:[(0,o.jsx)("button",{type:"button",className:"icon-btn icon-btn--view",onClick:()=>se(e.id),title:"Ver","aria-label":"Ver",children:"\ud83d\udc41\ufe0f"}),(0,o.jsx)("button",{type:"button",className:"icon-btn",onClick:()=>(async e=>{try{const a=await t.HV.exportar(e),n=window.URL.createObjectURL(new Blob([a.data])),r=document.createElement("a");r.href=n,r.setAttribute("download","inventario_".concat(e,".xlsx")),document.body.appendChild(r),r.click(),r.parentNode.removeChild(r)}catch(a){console.error("Error exportando:",a)}})(e.id),title:"Excel","aria-label":"Excel",children:"\ud83d\udcca"})]})]},e.id))})]})})}),k&&(0,o.jsxs)("div",{className:"camera-modal",role:"dialog","aria-modal":"true","aria-label":"Camara",children:[(0,o.jsx)("div",{className:"camera-modal__backdrop",onClick:ge}),(0,o.jsxs)("div",{className:"camera-modal__content",children:[(0,o.jsxs)("div",{className:"camera-modal__header",children:[(0,o.jsx)("h3",{children:"Escaner de codigo"}),(0,o.jsx)("div",{className:"camera-actions",children:(0,o.jsx)("button",{type:"button",className:"btn-link",onClick:ge,children:"Cancelar"})})]}),(0,o.jsxs)("div",{className:"camera-modal__preview",children:[(0,o.jsx)("video",{ref:q,autoPlay:!0,playsInline:!0,muted:!0,onLoadedMetadata:ye}),(0,o.jsxs)("div",{className:"scan-overlay","aria-hidden":"true",children:[(0,o.jsx)("div",{className:"scan-cross"}),(0,o.jsx)("div",{className:"scan-line"})]})]}),(0,o.jsx)("p",{className:"camera-note",children:_?"Escaneo automatico activado.":"Iniciando camara..."})]})]}),z&&(0,o.jsxs)("div",{className:"inicio-modal",role:"dialog","aria-modal":"true","aria-label":"Inicio inventario",children:[(0,o.jsx)("div",{className:"inicio-modal__backdrop",onClick:()=>A(!1)}),(0,o.jsxs)("div",{className:"inicio-modal__content",children:[(0,o.jsxs)("div",{className:"inicio-modal__header",children:[(0,o.jsx)("h3",{children:"Inicio de inventario"}),(0,o.jsx)("button",{type:"button",className:"btn-link",onClick:()=>A(!1),children:"Cerrar"})]}),(0,o.jsxs)("div",{className:"inicio-modal__body",children:[(0,o.jsxs)("div",{className:"inicio-info",children:[(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{className:"inicio-label",children:"Fecha / Hora"}),(0,o.jsx)("strong",{children:(new Date).toLocaleString()})]}),(0,o.jsxs)("div",{children:[(0,o.jsx)("span",{className:"inicio-label",children:"Usuario"}),(0,o.jsxs)("strong",{children:[re.nombre||"Usuario"," ",re.apellido||""]})]})]}),ie?(0,o.jsxs)("div",{className:"inicio-alert",children:["Hay un inventario abierto (ID ",ie.id,"). Puedes continuar o eliminarlo."]}):(0,o.jsx)("div",{className:"inicio-alert neutral",children:"No hay inventarios abiertos. Puedes iniciar uno nuevo."})]}),(0,o.jsxs)("div",{className:"inicio-modal__footer",children:[ie&&(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)("button",{type:"button",className:"btn-secondary",onClick:async()=>{ie&&await se(ie.id)},children:"Continuar"}),(0,o.jsx)("button",{type:"button",className:"btn-secondary danger",onClick:async()=>{if(!ie)return;if(window.confirm("Deseas eliminar el inventario abierto?"))try{await t.HV.eliminarInventario(ie.id),await ce(),A(!1),e===ie.id&&(a(null),s("abierto"),d(null),v([]))}catch(i){var n,r;console.error("Error eliminando inventario:",i),f((null===(n=i.response)||void 0===n||null===(r=n.data)||void 0===r?void 0:r.error)||"No se pudo eliminar inventario")}},children:"Eliminar"})]}),(0,o.jsx)("button",{type:"button",className:"btn-primary",onClick:async()=>{try{const e=await t.HV.crear({});await se(e.data.id),f(""),A(!1)}catch(e){console.error("Error creando inventario:",e),f("No se pudo iniciar inventario")}},children:"Empezar"})]})]})]}),H&&(0,o.jsx)("div",{className:"modal-overlay",role:"dialog","aria-modal":"true","aria-label":"Aplicar inventario",children:(0,o.jsxs)("div",{className:"modal-content",children:[(0,o.jsxs)("div",{className:"modal-header",children:[(0,o.jsx)("h2",{children:"Aplicar inventario"}),(0,o.jsx)("button",{type:"button",className:"btn-icon",onClick:()=>D(!1),children:"X"})]}),(0,o.jsxs)("div",{className:"modal-body",children:[(0,o.jsx)("p",{children:"Selecciona el inventario a aplicar. Por defecto es el ultimo registrado."}),(0,o.jsx)("div",{className:"form-row",children:(0,o.jsxs)("div",{className:"form-group",children:[(0,o.jsx)("label",{children:"Inventario"}),(0,o.jsxs)("select",{value:T,onChange:e=>V(e.target.value),children:[(0,o.jsx)("option",{value:"",children:"Seleccionar"}),x.map(e=>(0,o.jsxs)("option",{value:e.id,children:["#",e.id," - ",e.estado," - ",new Date(e.created_at).toLocaleString()]},e.id))]})]})}),(0,o.jsx)("p",{className:"warning-message",children:"Se actualizara el stock de productos segun el inventario seleccionado."})]}),(0,o.jsxs)("div",{className:"modal-footer",children:[(0,o.jsx)("button",{type:"button",className:"btn-secondary",onClick:()=>D(!1),children:"Cancelar"}),(0,o.jsx)("button",{type:"button",className:"btn-primary",onClick:async()=>{if(T)try{await t.HV.aplicar(T),await he(),await ce(),D(!1),C("Stock actualizado"),setTimeout(()=>C(""),1500)}catch(n){var e,a;console.error("Error aplicando stock:",n),f((null===(e=n.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.error)||"Error al aplicar stock")}else f("Selecciona un inventario para aplicar.")},disabled:!T,children:"Aplicar"})]})]})})]})}}}]);